{% extends "base.html" %} {%
block content %}
<div class="row mb-3">
  <div class="col-md-6">
    <h2><i class="bi bi-truck"></i> Suppliers</h2>
  </div>
  <div class="col-md-6 text-end">
    <a href="{{ url_for('supplier_new') }}" class="btn btn-primary">
      <i class="bi bi-plus-circle"></i> Add Supplier
    </a>
  </div>
</div>

<!-- Search -->
<div class="card mb-3">
  <div class="card-body">
    <form method="GET" class="row g-3">
      <div class="col-md-10">
        <input
          type="text"
          name="q"
          class="form-control"
          placeholder="Search suppliers..."
          value="{{ q }}"
        />
      </div>
      <div class="col-md-2">
        <button type="submit" class="btn btn-primary w-100">
          <i class="bi bi-search"></i> Search
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Suppliers Table -->
{% if pagination.items %}
<div class="card">
  <div class="table-responsive">
    <table class="table table-hover mb-0">
      <thead class="table-light">
        <tr>
          <th>Supplier Name</th>
          <th>Contact Person</th>
          <th>Email</th>
          <th>Phone</th>
          <th class="text-center">Rating</th>
          <th class="text-center">Products</th>
          <th class="text-center">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for supplier in pagination.items %}
        <tr>
          <td><strong>{{ supplier.name }}</strong></td>
          <td>{{ supplier.contact_person or '-' }}</td>
          <td>{{ supplier.email or '-' }}</td>
          <td>{{ supplier.phone or '-' }}</td>
          <td class="text-center">
            {% for i in range(supplier.rating) %}
            <i class="bi bi-star-fill text-warning"></i>
            {% endfor %}
          </td>
          <td class="text-center">
            <a
              href="{{ url_for('products', supplier=supplier.id) }}"
              class="badge bg-info"
            >
              {{ supplier.products.count() }}
            </a>
          </td>
          <td class="text-center">
            <div class="btn-group btn-group-sm">
              <a
                href="{{ url_for('supplier_edit', sid=supplier.id) }}"
                class="btn btn-outline-primary"
                title="Edit"
              >
                <i class="bi bi-pencil"></i>
              </a>
              <form
                method="POST"
                action="{{ url_for('supplier_delete', sid=supplier.id) }}"
                style="display: inline"
                onsubmit="return confirm('Delete this supplier?');"
              >
                <button
                  type="submit"
                  class="btn btn-outline-danger btn-sm"
                  title="Delete"
                >
                  <i class="bi bi-trash"></i>
                </button>
              </form>
            </div>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<!-- Pagination -->
{% if pagination.pages > 1 %}
<nav class="mt-3">
  <ul class="pagination justify-content-center">
    {% if pagination.has_prev %}
    <li class="page-item">
      <a
        class="page-link"
        href="{{ url_for('suppliers', page=pagination.prev_num, q=q) }}"
        >Previous</a
      >
    </li>
    {% endif %}

    <li class="page-item active">
      <span class="page-link"
        >{{ pagination.page }} / {{ pagination.pages }}</span
      >
    </li>

    {% if pagination.has_next %}
    <li class="page-item">
      <a
        class="page-link"
        href="{{ url_for('suppliers', page=pagination.next_num, q=q) }}"
        >Next</a
      >
    </li>
    {% endif %}
  </ul>
</nav>
{% endif %} {% else %}
<div class="alert alert-info">
  <i class="bi bi-info-circle"></i> No suppliers found.
  <a href="{{ url_for('supplier_new') }}">Add a new supplier</a>.
</div>
{% endif %} {% endblock %}
